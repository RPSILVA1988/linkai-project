function a0_0xd9ad(_0x38ec1d,_0x244a0b){const _0x1d4c39=a0_0x1d4c();return a0_0xd9ad=function(_0xd9ad1f,_0x27d048){_0xd9ad1f=_0xd9ad1f-0x1c9;let _0x21ebd4=_0x1d4c39[_0xd9ad1f];return _0x21ebd4;},a0_0xd9ad(_0x38ec1d,_0x244a0b);}const a0_0x4d65c6=a0_0xd9ad;(function(_0xd43d1a,_0x37ca3c){const _0xb21adc=a0_0xd9ad,_0x471abc=_0xd43d1a();while(!![]){try{const _0x365605=-parseInt(_0xb21adc(0x1ca))/0x1+parseInt(_0xb21adc(0x1d8))/0x2+parseInt(_0xb21adc(0x1e6))/0x3*(-parseInt(_0xb21adc(0x1cd))/0x4)+parseInt(_0xb21adc(0x1ef))/0x5*(-parseInt(_0xb21adc(0x1d6))/0x6)+-parseInt(_0xb21adc(0x1ce))/0x7*(parseInt(_0xb21adc(0x1c9))/0x8)+-parseInt(_0xb21adc(0x1cb))/0x9*(-parseInt(_0xb21adc(0x1d9))/0xa)+parseInt(_0xb21adc(0x1e2))/0xb;if(_0x365605===_0x37ca3c)break;else _0x471abc['push'](_0x471abc['shift']());}catch(_0x1852d4){_0x471abc['push'](_0x471abc['shift']());}}}(a0_0x1d4c,0x2be38));function a0_0x1d4c(){const _0xb4d324=['\x0a\x20\x20\x20\x20\x20\x20\x20\x20<h1>Password\x20Reset</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p>You\x20requested\x20a\x20password\x20reset\x20for\x20your\x20Link.aí\x20account.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p>Your\x20verification\x20code\x20is:\x20<strong>','findOne','_id','resetPasswordCode','findById','1793082IuMPzT','../models/User','638460wmSrjm','3310rOFjOt','matchPassword','../config/email','email','User\x20with\x20that\x20email\x20does\x20not\x20exist','verifyResetCode','username','select','Invalid\x20credentials','4461787Zrgxrb','resetPasswordExpire','generateResetCode','name','364782vAYqlW','json','body','bio','forgotPassword','status','+resetPasswordCode\x20+resetPasswordExpire','+password','getMe','5SYfBmd','password','login','register','resetPassword','Invalid\x20or\x20expired\x20reset\x20code','create','47984AQGwvy','224142ZEePYR','7272jopclD','Password\x20reset\x20code\x20sent\x20to\x20email','4TtOLRV','196wLXUEs','user','save'];a0_0x1d4c=function(){return _0xb4d324;};return a0_0x1d4c();}const User=require(a0_0x4d65c6(0x1d7)),{generateToken}=require('../middleware/auth'),{sendEmail}=require(a0_0x4d65c6(0x1db));exports[a0_0x4d65c6(0x1f2)]=async(_0x4991fb,_0x4367d1,_0x352e68)=>{const _0x2c5c4b=a0_0x4d65c6;try{const {name:_0x31e0b5,username:_0xec4d5b,email:_0x33f615,password:_0x3adc01}=_0x4991fb['body'],_0x4d7f51=await User['findOne']({'$or':[{'email':_0x33f615},{'username':_0xec4d5b}]});if(_0x4d7f51)return _0x4367d1[_0x2c5c4b(0x1eb)](0x190)['json']({'success':![],'message':'User\x20with\x20that\x20email\x20or\x20username\x20already\x20exists'});const _0x4c82d4=await User[_0x2c5c4b(0x1f5)]({'name':_0x31e0b5,'username':_0xec4d5b,'email':_0x33f615,'password':_0x3adc01}),_0x1f333a=generateToken(_0x4c82d4[_0x2c5c4b(0x1d3)]);_0x4367d1['status'](0xc9)[_0x2c5c4b(0x1e7)]({'success':!![],'token':_0x1f333a,'user':{'id':_0x4c82d4[_0x2c5c4b(0x1d3)],'name':_0x4c82d4[_0x2c5c4b(0x1e5)],'username':_0x4c82d4[_0x2c5c4b(0x1df)],'email':_0x4c82d4[_0x2c5c4b(0x1dc)],'bio':_0x4c82d4[_0x2c5c4b(0x1e9)]}});}catch(_0x581260){_0x352e68(_0x581260);}},exports[a0_0x4d65c6(0x1f1)]=async(_0x457659,_0x236070,_0x15a2da)=>{const _0x37e1bc=a0_0x4d65c6;try{const {username:_0x1ec538,password:_0x25f94d}=_0x457659[_0x37e1bc(0x1e8)],_0x32f726=await User[_0x37e1bc(0x1d2)]({'username':_0x1ec538})[_0x37e1bc(0x1e0)](_0x37e1bc(0x1ed));if(!_0x32f726)return _0x236070['status'](0x191)[_0x37e1bc(0x1e7)]({'success':![],'message':_0x37e1bc(0x1e1)});const _0x58d3a4=await _0x32f726[_0x37e1bc(0x1da)](_0x25f94d);if(!_0x58d3a4)return _0x236070[_0x37e1bc(0x1eb)](0x191)[_0x37e1bc(0x1e7)]({'success':![],'message':_0x37e1bc(0x1e1)});const _0x3a8030=generateToken(_0x32f726[_0x37e1bc(0x1d3)]);_0x236070['json']({'success':!![],'token':_0x3a8030,'user':{'id':_0x32f726[_0x37e1bc(0x1d3)],'name':_0x32f726[_0x37e1bc(0x1e5)],'username':_0x32f726[_0x37e1bc(0x1df)],'email':_0x32f726[_0x37e1bc(0x1dc)],'bio':_0x32f726[_0x37e1bc(0x1e9)]}});}catch(_0x5517c0){_0x15a2da(_0x5517c0);}},exports[a0_0x4d65c6(0x1ea)]=async(_0x5ecca5,_0x501284,_0x1c1da4)=>{const _0x41919c=a0_0x4d65c6;try{const {email:_0x2d3988}=_0x5ecca5[_0x41919c(0x1e8)],_0x14b9ed=await User[_0x41919c(0x1d2)]({'email':_0x2d3988});if(!_0x14b9ed)return _0x501284['status'](0x194)['json']({'success':![],'message':_0x41919c(0x1dd)});const _0x53b053=_0x14b9ed[_0x41919c(0x1e4)]();await _0x14b9ed[_0x41919c(0x1d0)]();const _0xc9c1e9={'to':_0x14b9ed[_0x41919c(0x1dc)],'subject':'Password\x20Reset\x20-\x20Link.aí','html':_0x41919c(0x1d1)+_0x53b053+'</strong></p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p>This\x20code\x20will\x20expire\x20in\x2010\x20minutes.</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p>If\x20you\x20didn\x27t\x20request\x20this,\x20please\x20ignore\x20this\x20email.</p>\x0a\x20\x20\x20\x20\x20\x20'};await sendEmail(_0xc9c1e9),_0x501284[_0x41919c(0x1e7)]({'success':!![],'message':_0x41919c(0x1cc)});}catch(_0xd7521){_0x1c1da4(_0xd7521);}},exports[a0_0x4d65c6(0x1f3)]=async(_0x1e8e65,_0xa844b0,_0x452a4f)=>{const _0x41cf2f=a0_0x4d65c6;try{const {email:_0x3bd689,code:_0x22c448,password:_0x350b1c}=_0x1e8e65[_0x41cf2f(0x1e8)],_0x5ba05a=await User[_0x41cf2f(0x1d2)]({'email':_0x3bd689})[_0x41cf2f(0x1e0)](_0x41cf2f(0x1ec));if(!_0x5ba05a)return _0xa844b0[_0x41cf2f(0x1eb)](0x194)[_0x41cf2f(0x1e7)]({'success':![],'message':_0x41cf2f(0x1dd)});if(!_0x5ba05a[_0x41cf2f(0x1d4)]||!_0x5ba05a[_0x41cf2f(0x1e3)])return _0xa844b0['status'](0x190)[_0x41cf2f(0x1e7)]({'success':![],'message':'Invalid\x20or\x20expired\x20reset\x20code'});const _0x56a67b=_0x5ba05a[_0x41cf2f(0x1de)](_0x22c448);if(!_0x56a67b)return _0xa844b0[_0x41cf2f(0x1eb)](0x190)[_0x41cf2f(0x1e7)]({'success':![],'message':_0x41cf2f(0x1f4)});_0x5ba05a[_0x41cf2f(0x1f0)]=_0x350b1c,_0x5ba05a[_0x41cf2f(0x1d4)]=undefined,_0x5ba05a[_0x41cf2f(0x1e3)]=undefined,await _0x5ba05a[_0x41cf2f(0x1d0)](),_0xa844b0[_0x41cf2f(0x1e7)]({'success':!![],'message':'Password\x20reset\x20successful'});}catch(_0x13ef4e){_0x452a4f(_0x13ef4e);}},exports[a0_0x4d65c6(0x1ee)]=async(_0x51bf75,_0x608ae5,_0x440270)=>{const _0x19da87=a0_0x4d65c6;try{const _0x4beaa8=await User[_0x19da87(0x1d5)](_0x51bf75[_0x19da87(0x1cf)]['id']);_0x608ae5[_0x19da87(0x1e7)]({'success':!![],'user':{'id':_0x4beaa8['_id'],'name':_0x4beaa8[_0x19da87(0x1e5)],'username':_0x4beaa8[_0x19da87(0x1df)],'email':_0x4beaa8[_0x19da87(0x1dc)],'bio':_0x4beaa8['bio']}});}catch(_0x556078){_0x440270(_0x556078);}};